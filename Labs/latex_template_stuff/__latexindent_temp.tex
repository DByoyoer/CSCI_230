\documentclass{article}
\usepackage{minted}
\usepackage[margin=0.5in]{geometry} %used to set the margins
\title{Lab 1}
\author{Michael Morikawa}
\date{\today}


\begin{document}
    \maketitle
    \begin{minted}{c++}
#include "AVLTree.hpp"
#include <fstream>
#include <sstream>

AVLTree::AVLTree() : SearchTree() {}

AVLTree::AVLTree(std::string filepath)
{
    std::ifstream infile(filepath);
    if (!infile)
    {
        std::cout << "Probs";
    }
    std::string line;
    std::string strTemp;
    int code, pop;
    while (getline(infile, line))
    {
        std::stringstream ss(line);
        getline(ss, strTemp, ',');
        code = std::stoi(strTemp);
        getline(ss, strTemp, ',');
        pop = std::stoi(strTemp);
        getline(ss, strTemp);
        std::string county = strTemp.substr(1, strTemp.size() - 3); //Removing Quotes
        insert(code, pop, county);
    }
}

void AVLTree::find(int code)
{
    TPos p = finder(code, root());
    if (p.isInternal())
    {

        std::cout << "County/State: " << (*p).value().name << "\nPopulation: " << (*p).value().population << '\n';
    }
    else
    {
        std::cout << "Could not find key\n";
    }
    std::cout << "AVL: Examined " << nodesExamined << " nodes\n";
}

int AVLTree::height(const TPos &v) const
{
    if (v == root().parent())
    {
        return (*root()).getHeight();
    }
    return (v.isExternal() ? 0 : (*v).getHeight());
}

void AVLTree::setHeight(TPos v)
{
    if (v.isExternal())
    {
        (*v).setHeight(0);
        return;
    }

    int leftHeight = height(v.left());
    int rightHeight = height(v.right());
    (*v).setHeight(1 + std::max(leftHeight, rightHeight));
}

bool AVLTree::isBalanced(const TPos &v) const
{
    int bal = height(v.left()) - height(v.right());
    return ((-1 <= bal) && (bal <= 1));
}

AVLTree::TPos AVLTree::tallGrandchild(const TPos &z) const
{
    TPos zLeft = z.left();
    TPos zRight = z.right();
    if (height(zLeft) >= height(zRight))
    {
        if (height(zLeft.left()) >= height(zLeft.right()))
        {
            return zLeft.left();
        }
        else
        {
            return zLeft.right();
        }
    }
    else
    {
        if (height(zRight.right()) >= height(zRight.left()))
        {
            return zRight.right();
        }
        else
        {
            return zRight.left();
        }
    }
}

void AVLTree::rebalance(const TPos &v)
{
    TPos z = v;
    while (z != SearchTree::root())
    {
        z = z.parent();

        setHeight(z);
        if (!isBalanced(z))
        {
            TPos x = tallGrandchild(z);
            z = restructure(x);
            setHeight(z.right());
            setHeight(z.left());
            setHeight(z);
        }
    }
}

AVLTree::Iterator AVLTree::insert(int key, const County &value)
{
    TPos v = inserter(key, value);
    std::cout << "AVL: Examined " << nodesExamined << " nodes\n";
    setHeight(v);
    rebalance(v);
    return Iterator(v);
}

void AVLTree::insert(int code, int pop, std::string name)
{
    County value(pop, name);
    TPos v = inserter(code, value);
    std::cout << "AVL: Examined " << nodesExamined << " nodes\n";
    setHeight(v);
    rebalance(v);
}

void AVLTree::erase(int code)
{
    TPos v = finder(code, SearchTree::root());
    std::cout << "AVL: Examined " << nodesExamined << " nodes\n";

    if (v.isExternal())
    {
        throw NonexistentElement("Erase of nonexistent");
    }

        TPos w = eraser(v);
    rebalance(w);
}
    \end{minted}

\end{document}